{% extends 'coreapp/base.html' %}
{% block title %}{{ student.full_name }} — Results{% endblock %}

{% block content %}
<div class="container mt-4">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h3>{{ student.full_name }} — Results</h3>
    <form method="GET" class="d-flex">
      <input type="hidden" name="student" value="{{ student.id }}">
      <select name="term" class="form-select me-2">
        <option value="">Select Term</option>
        {% for t in terms %}
          <option value="{{ t.id }}" {% if term and t.id == term.id %}selected{% endif %}>{{ t.name }}</option>
        {% endfor %}
      </select>
      <button class="btn btn-primary">View</button>
    </form>
  </div>

  {% if term %}
    <h5 class="mb-3">{{ term.name }}</h5>
  {% endif %}

  {% if marks %}
    <table class="table table-bordered">
      <thead class="table-secondary">
        <tr>
          <th>Subject</th>
          <th>Score</th>
          <th>Grade</th>
          <th>Teacher</th>
          <th>Comment</th>
        </tr>
      </thead>
      <tbody>
        {% for mark in marks %}
        <tr>
          <td>{{ mark.subject.name }}</td>
          <td class="text-center">{{ mark.score }}</td>
          <td class="text-center">{{ mark.grade }}</td>
          <td>{% if mark.teacher %}
  {{ mark.teacher.full_name }}
{% else %}
  —
{% endif %}
</td>
          <td>{{ mark.comment }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>

    <div class="mt-3">
      <strong>Average:</strong> {{ average|default:"N/A" }}
      {% if position %}
        &nbsp; | &nbsp; <strong>Class position:</strong> {{ position }}
      {% endif %}
    </div>
  {% else %}
    <p>No marks for selected term yet.</p>
  {% endif %}
</div>
{% endblock %}
